# SOLVER-Ralph Environment Configuration Example
# Copy this file to .env and fill in your values
#
# For development, you can use the defaults generated by deploy/init.sh
# For production, use Infisical or another secrets manager

# ============================================================================
# PostgreSQL Configuration
# ============================================================================
SR_POSTGRES_HOST=localhost
SR_POSTGRES_PORT=5432
SR_POSTGRES_USER=postgres
SR_POSTGRES_PASSWORD=postgres
SR_POSTGRES_DB=solver_ralph
SR_DATABASE_URL=postgres://postgres:postgres@localhost:5432/solver_ralph

# ============================================================================
# MinIO Configuration (S3-compatible object storage)
# ============================================================================
MINIO_ENDPOINT=http://localhost:9000
MINIO_REGION=us-east-1
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_BUCKET=evidence

# ============================================================================
# NATS Configuration (Message bus)
# ============================================================================
SR_NATS_URL=nats://localhost:4222
SR_NATS_STREAM_PREFIX=sr
SR_NATS_CONSUMER_PREFIX=sr-consumer
SR_NATS_MESSAGE_TTL_SECS=604800
SR_NATS_MAX_MSGS_PER_SUBJECT=-1
SR_NATS_DUPLICATE_WINDOW_SECS=120

# ============================================================================
# Zitadel OIDC Configuration
# ============================================================================
SR_OIDC_ISSUER=http://localhost:8080
SR_OIDC_AUDIENCE=solver-ralph
SR_OIDC_CLIENT_ID=<configure-in-zitadel>
SR_OIDC_CLIENT_SECRET=<configure-in-zitadel>

# ============================================================================
# Infisical Configuration (D-16: Secrets Management)
# ============================================================================
# Required for production envelope key management
# For development, see deploy/.env.secrets for local defaults

# Infisical service token (Universal Auth or Service Token)
INFISICAL_TOKEN=

# Infisical workspace ID (from project settings)
INFISICAL_WORKSPACE_ID=

# Infisical API endpoint (default: https://app.infisical.com)
# Use http://localhost:8080 for self-hosted Infisical
INFISICAL_API_ENDPOINT=https://app.infisical.com

# Environment to use (dev, staging, prod)
INFISICAL_ENVIRONMENT=dev

# Key ID for envelope encryption KEK
# The actual KEK is stored at: solver-ralph/kek/{envelope_key_id}
INFISICAL_ENVELOPE_KEY_ID=solver-ralph-kek

# ============================================================================
# API Server Configuration
# ============================================================================
SR_HOST=0.0.0.0
SR_PORT=3000
SR_LOG_LEVEL=debug
SR_LOG_FORMAT=pretty  # pretty or json

# Enable semantic worker for agentic orchestration
SR_ENABLE_SEMANTIC_WORKER=false

# ============================================================================
# Development Envelope Key (D-16)
# ============================================================================
# WARNING: This is a development-only key!
# For production, use Infisical to manage envelope keys.
#
# Generate a production key with: openssl rand -base64 32
SR_ENVELOPE_KEY_ID=dev-kek-001
SR_ENVELOPE_KEY=

# ============================================================================
# Attachment Storage (V7-3)
# ============================================================================
SR_ATTACHMENT_BUCKET=artifacts
SR_ATTACHMENT_MAX_SIZE_MB=100
